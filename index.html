<!DOCTYPE html>
<html>
 <head>
  <meta property='og:title' content='Hitung Kadar Emas'>
  <meta name='description' content='Berdasarkan berat luar & dalam air.'>
  <meta property="og:image" content='https://sukedi.github.io/emas/emas.jpg'>
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <title>Hitung Kadar Emas</title>
  <style>
   body, input, table, tr, th, td {
    font-family:arial;
    font-size:16px;
   }
   #spn {
    background-color: black;
    color: white;
    display: inline-block;
    position: relative;
    width: 300px;
    overflow: hidden;
   }
   input[type="number"] {
    width: 125px;
   }
   .checkbox-big {
    transform: scale(1.3);
    margin: 5px;
   }
   #hasil {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    transition: all 1s ease;
   }
  </style>
 </head>
 <body onLoad="detekOS()">
   <center>
   <img src="emas.jpg" width="100">
   <div style="font-size:2em;"><b>Hitung Kadar Emas</b></div>
   </center><hr>
   <table width="100%">
     <tr>
       <td rowspan="3" width="5%">&nbsp;</td>
       <td width="38%">Weight in Air</td>
       <td width="52%">
         <input type="number" id="w1" placeholder="0">
       </td>
       <td rowspan="3" width="5%">&nbsp;</td>
     </tr>
     <tr>
       <td>Weight in Water</td>
       <td>
         <input type="number" id="w2" placeholder="0">
       </td>
     </tr>
     <tr>
       <td>Kondisi</td>
       <td>
         <input type="checkbox" id="c1" class="checkbox-big">
         <label onClick="cek(1)">Warna 1</label><br>
         <input type="checkbox" id="c2" class="checkbox-big">
         <label onClick="cek(2)">Warna 2</label><br>
         <input type="checkbox" id="c3" class="checkbox-big">
         <label onClick="cek(3)">Warna 3</label>
       </td>
     </tr>
   </table><hr>
   <center>
   <span class="spn" id="hasil" style="background-color:black; 
     font-size:2em; color:white; font-weight:bold;">Kadar : 0.00</span>
   <div><button onClick="hitung()" style="font-size:20px; font-weight:bold;">
   HITUNG</button></div>
   <p><div id="key"></div></p>
   <p><div id="key2"></div></p>
   <p><div id="hash"></div></p>
   </center>
 
<script>
function detekOS() {
    let userAgent = navigator.userAgent || navigator.vendor || window.opera;
    if (/android/i.test(userAgent)) {
        os = "Android";
    } else if (/iPhone|iPad|iPod/i.test(userAgent)) {
        os = "iPhone";
    } else if (/Windows NT/i.test(userAgent)) {
        os = "Windows";
    } else {
        os = "Unknown";
    }
    if (os !== "Android" && os !== "iPhone"){
        window.location.replace("https://sukedi.github.io/emas/ditolak.html");
    } else {
        fetchData();
    }
}

async function device_id(){
const userAgent = navigator.userAgent;
const platform = navigator.platform;
const screenWidth = window.screen.width;
const screenHeight = window.screen.height;
const fingerprint = `${userAgent};${platform};${screenWidth}x${screenHeight}`;
let hash = await hashSHA256(fingerprint);
document.getElementById("hash").innerHTML = hash;
}

async function hashSHA256(text) {
    const encoder = new TextEncoder();
    const data = encoder.encode(text);
    const hashBuffer = await crypto.subtle.digest("SHA-256", data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map(byte => byte.toString(16).padStart(2, "0")).join("");
    return hashHex;
}
async function fetchData() {
    const url = "key.php";        
    try {
      const response = await fetch(url);
      const text = await response.text()
      document.getElementById("key").innerHTML = text;
    } catch (error) {
      document.getElementById("key").innerHTML = "None";
    }
    device_id();
}
 
function hitung(){
    let brt1 = document.getElementById("w1").value;
    let brt2 = document.getElementById("w2").value;
    if (brt1 * brt2 == 0){
        Swal.fire({
          title: "Error",
          text: "Berat tidak boleh nol!",
          icon: "error"
        });
        return;
    }
    hsl=brt1/brt2;
    document.getElementById("hasil").innerHTML= "Kadar : "+hsl.toFixed(2);
    document.getElementById("w1").value="";
    document.getElementById("w2").value="";
    document.getElementById("c1").checked = false;
    document.getElementById("c2").checked = false;
    document.getElementById("c3").checked = false;
    showHasil();
}

function cek(nn){
    cdx = "c"+nn.toString();
    vc1 = document.getElementById(cdx).checked;
    document.getElementById(cdx).checked = !vc1;
}
 
document.getElementById("w1").addEventListener("input", function () {
    if (this.value.length > 4) {
        this.value = this.value.slice(0, 4);
    }
});

document.getElementById("w2").addEventListener("input", function () {
    if (this.value.length > 4) {
        this.value = this.value.slice(0, 4);
    }
});

let hasil = document.getElementById("hasil");
let input = document.getElementById("w1");
input.addEventListener("input", function() {
hasil.style.left = "-50px";  // Geser ke kiri
hasil.style.opacity = "0";   // Hilang
});

function showHasil() {
hasil.style.left = "50%";  // Kembali ke tengah
hasil.style.opacity = "1"; // Muncul lagi
}
</script>
</body>
</html>
